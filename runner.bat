@echo offsetlocal enabledelayedexpansion:: Pathsset "INSTALLER=%USERPROFILE%\Downloads\iCloudSetup.exe"set "EXTRACTED=%USERPROFILE%\Downloads\iCloudExtracted"set "SEVENZIP=C:\Program Files\7-Zip\7z.exe":: Step 1: Extract installer using 7-Zipecho Extracting iCloudSetup.exe..."%SEVENZIP%" x "%INSTALLER%" -o"%EXTRACTED%" -yif errorlevel 1 (echo Failed to extract iCloudSetup.exegoto end):: Step 2: Install MSI packages silentlycd /d "%EXTRACTED%"echo Installing AppleApplicationSupport.msi...msiexec /i AppleApplicationSupport.msi /quiet /norestartecho Installing AppleSoftwareUpdate.msi...msiexec /i AppleSoftwareUpdate.msi /quiet /norestartecho Installing iCloud.msi...msiexec /i iCloud.msi /quiet /norestartif exist Bonjour.msi (echo Installing Bonjour.msi...msiexec /i Bonjour.msi /quiet /norestart)if exist AppleMobileDeviceSupport64.msi (echo Installing AppleMobileDeviceSupport64.msi...msiexec /i AppleMobileDeviceSupport64.msi /quiet /norestart):: Step 3: Wait for all msiexec.exe processes to finishecho Waiting for all installer processes to finish...:waitlooptasklist /FI "IMAGENAME eq msiexec.exe" | find /I "msiexec.exe" >nulif %ERRORLEVEL%==0 (timeout /t 3 /nobreak >nulgoto waitloop):: Step 4: Delete extracted foldercd /d "%USERPROFILE%\Downloads"echo Deleting extracted folder...rmdir /s /q "iCloudExtracted"echo iCloud silent installation completed successfully.:endpause
